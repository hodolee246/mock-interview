# 사용자 수에 따른 규모 확장성

<aside>
💡

다시 읽어보니 1장부터 이직에 대한 핵심 키워드를 설명하네요
채용공고에 단골로 등장하는 내용

**일정 이상 트래픽을 핸들링한 경험**

</aside>

1. 데이터베이스
    1. RDBMS
    2. NoSQL
2. 확장
    1. 스케일업
    2. 스케일아웃
3. 로드밸런서
4. 데이터베이스 다중화
5. 캐시
6. CND
7. 무상태 웹계층
8. 데이터 센터
9. 메시지 큐
10. 로그, 메트릭 그리고 자동화
11. 데이터베이스 규모확장

# 지금 당장

할 수 있는 방법으로는 아무래도 새로운 애플리케이션을 만든다면 어떤 **데이터베이스**를 사용할지

를 제외한 나머지 방법 중 간단한 것은 **캐시**라 생각

- 캐시

# 캐시전략

1. Look Aside Cache
2. Write Back
3. Read Through
4. Write Through
5. Write Around

<aside>
💡

어떤 데이터를 캐시에 저장하는게 좋을까?

캐시 히트율
(적중률 = 적중횟수 / 총 접근 횟수 ) 이 0.95~0.99 정도가 되어야 적절한 캐시를 우수하게 사용했다고 할 수 있다.

</aside>

## Look Aside Cache

![출처 : 우아한테크세미나 191121 우아한레디스 강대명님](attachment:d1dd2a45-f30c-4604-9e1a-594f403e17a2:image.png)

출처 : 우아한테크세미나 191121 우아한레디스 강대명님

의도된 전략이 없다면 가장 많이 사용되는 캐시전략으로 캐시와 DB가 분리되어 가용되며, 원하는 데이터만 별도로 캐시에 저장을 하여 캐시에서 조회가 가능하다면 캐시에서, 그렇지 않으면 DB에서 조회한다.

## Write Back

![출처 : 우아한테크세미나 191121 우아한레디스 강대명님](attachment:7f57dd3f-5616-4a38-974e-b3795c406cd9:image.png)

출처 : 우아한테크세미나 191121 우아한레디스 강대명님

조회용이 아닌 쓰기용 캐시전략으로 매순간 데이터를 Write하는게 아니라 배치형식으로 캐시에 저장용 데이터를 모아 한번에 DB에 반영한다.

- 저장할 데이터가 500개가 있다고 가정했을때 Insert 1번을 * 500번 보다 Insert 1번(500개)번 날리는게 훨씬 빠르다.

## Read Through

![image.png](attachment:88da7b4a-abed-4f92-9b1a-52b0cd94dc66:image.png)

데이터 조회를 DB가 아닌 캐시에게 위임하여 전적으로 캐시에서만 데이터를 조회하여 사용 항상 DB와 캐시간 동기화가 이루어져야 한다.

## Write Through

![image.png](attachment:4b5a5f75-3531-4833-8720-c3dbcb746265:image.png)

Write Back과 동일하게 캐시에서 DB로 Write를 하지만 배치형식이 아닌 리얼타임 방식을 이용한다.

## Write Around

![image.png](attachment:00116877-610b-43bd-93da-02cc0e36ae5b:image.png)

곧바로 DB에 데이터를 저장하는 방식이며, 캐시미스가 발생할 경우 DB, 캐시에 데이터를 저장

<aside>
💡

위에 같은 전략이 있지만 작은 단위의 애플리케이션에서는 JVM내 캐시를 저장해 사용하는 Caffenine을 사용한다고 한다.

저는 작은 단위여도 Redis를 도입했습니다

</aside>

![image.png](attachment:60a72c1e-d426-44d5-85bd-bbf728231051:image.png)

<aside>
💡

회사에서 사용하는 케이스인데

A에서는 DB에 Write
B에서는 DB에 Read

A가 스케줄러가 돌면서 하루에 N번씩 특정시간에 데이터를 저장하는데 이때 조회시간이 최대 3배까지 증가함

</aside>